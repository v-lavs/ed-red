{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["/*\n * to include js file write: `//= include ./path-to-file`\n */\n\n// ================== CONSTANTS ==================\n\nconst BREAKPOINTS = {\n    mobile: 767,\n    tablet: 991,\n};\n\nconst isMobile = () => window.innerWidth <= BREAKPOINTS.mobile;\nconst isTablet = () => window.innerWidth <= BREAKPOINTS.tablete;\n\n// ================== HELPERS ==================\n\nfunction destroySwiper(instance) {\n    if (instance && instance instanceof Swiper && instance.initialized) {\n        instance.destroy(true, true);\n    }\n}\n\nfunction lockScroll() {\n    document.body.style.overflow = 'hidden';\n}\n\nfunction unlockScroll() {\n    document.body.style.overflow = '';\n}\n\nfunction debounce(fn, delay) {\n    let t;\n    return (...args) => {\n        clearTimeout(t);\n        t = setTimeout(() => fn.apply(null, args), delay);\n    };\n}\n\n// ================== ALLERGENS ==================\n\nfunction initAllergenCategory($root = $(document)) {\n    $root.find('.category').each(function () {\n        const $category = $(this);\n        const $list = $category.find('.allergen-list');\n        const $btn = $category.find('.allergen-toggle-btn');\n\n        if (!$list.length || !$btn.length) return;\n\n        const $items = $list.children('.allergen-item');\n        const maxVisible = 6;\n\n        if (!isMobile()) {\n            $items.show();\n            $btn.hide();\n            $list.removeClass('is-collapsed');\n            $category.removeClass('open');\n            return;\n        }\n\n        if ($items.length <= maxVisible) {\n            $btn.hide();\n            return;\n        }\n\n        $btn.show();\n        $list.addClass('is-collapsed');\n        $category.removeClass('open');\n\n        $items.each((i, el) => {\n            if (i >= maxVisible) $(el).hide();\n        });\n    });\n}\n\n$(document).on('click', '.allergen-toggle-btn', function () {\n    const $btn = $(this);\n    const $category = $btn.closest('.category');\n    const $list = $category.find('.allergen-list');\n    const $items = $list.children('.allergen-item');\n    const $text = $btn.find('.btn-text');\n\n    const collapsed = $list.hasClass('is-collapsed');\n\n    if (collapsed) {\n        $list.removeClass('is-collapsed');\n        $items.slideDown(200);\n        $category.addClass('open');\n        $text.text('Закрити');\n    } else {\n        $list.addClass('is-collapsed');\n        $items.slice(6).slideUp(200);\n        $category.removeClass('open');\n        $text.text('Дивитись більше');\n    }\n});\n\nfunction initVisibleTabAllergens() {\n    const $activeTab = $('.tab-pane.active:visible');\n    if ($activeTab.length) {\n        initAllergenCategory($activeTab);\n    }\n}\n\n// ================== MENU ==================\n\nfunction initMobileMenu() {\n    const $nav = $('.header__nav');\n    const $backdrop = $('.backdrop');\n\n    $('.btn_burger').on('click', e => {\n        e.preventDefault();\n        $nav.addClass('open');\n        $backdrop.fadeIn();\n        lockScroll();\n    });\n\n    $('.btn_close, .backdrop').on('click', e => {\n        e.preventDefault();\n        $nav.removeClass('open');\n        $backdrop.fadeOut();\n        unlockScroll();\n    });\n\n    $('.menu').on('click', '.menu__toggler', function(e) {\n        e.preventDefault();\n\n        const $parent = $(this).parent();\n\n        $parent.toggleClass('is-open');\n    });\n\n\n}\n\n\n\n// ================== HEADER SEARCH (RESTORED) ==================\n\nfunction initHeaderSearch() {\n    const $searchBar = $('.header__search');\n    const $form = $('.search-form');\n\n    $('#openSearch').on('click', e => {\n        e.preventDefault();\n        $searchBar.addClass('active');\n    });\n\n    $('#closeSearch').on('click', e => {\n        e.preventDefault();\n        $searchBar.removeClass('active');\n        $form.removeClass('active');\n        $form.find('.form-control').val('');\n    });\n\n    $form.on('submit', function (e) {\n        e.preventDefault();\n        console.log('Form submitted:', $(this).serialize());\n    });\n}\n\n// ================== SMOOTH SCROLL ==================\n\nfunction initSmoothScroll(selectors) {\n    const $header = $('header');\n\n    $(document).on('click', selectors, function (e) {\n        const href = $(this).attr('href');\n        if (!href || !href.startsWith('#')) return;\n\n        const target = document.querySelector(href);\n        if (!target) return;\n\n        e.preventDefault();\n\n        $('html, body').animate(\n            { scrollTop: $(target).offset().top - $header.innerHeight() },\n            800\n        );\n\n        $('.header__nav').removeClass('open');\n        $('.backdrop').fadeOut();\n    });\n\n    if (location.hash) {\n        const target = document.querySelector(location.hash);\n        if (target) {\n            $('html, body').animate(\n                { scrollTop: $(target).offset().top - $header.innerHeight() },\n                800\n            );\n        }\n    }\n}\n\n// ================== VIDEO ==================\n\nfunction initVideo() {\n    const video = document.getElementById('promotion-video');\n    const $btn = $('#playButton');\n\n    if (!video || !$btn.length) return;\n\n    $btn.on('click', () => video.play());\n\n    video.addEventListener('play', () => {\n        $btn.hide();\n        video.controls = true;\n    });\n\n    video.addEventListener('pause', () => {\n        $btn.show();\n        video.controls = false;\n    });\n}\n\n// ================== SLIDERS ==================\n\nfunction initResponsiveCounterSlider() {\n    let slider = null;\n\n    function update() {\n        if (isMobile()) {\n            if (!slider && $('.swiper.counter').length) {\n                slider = new Swiper('.swiper.counter', {\n                    navigation: {\n                        nextEl: '.swiper-button-next',\n                        prevEl: '.swiper-button-prev',\n                    },\n                });\n            }\n        } else {\n            destroySwiper(slider);\n            slider = null;\n        }\n    }\n\n    update();\n    window.addEventListener('resize', debounce(update, 300));\n}\n\nfunction initStaticSliders() {\n    if ($('.slider-products').length) {\n        const slider = new Swiper('.slider-products', {\n            spaceBetween: 24,\n            slidesPerView: 1,\n            breakpoints: {\n                650: { slidesPerView: 2 },\n                1025: { slidesPerView: 3 },\n            },\n            pagination: { el: '.swiper-pagination', clickable: true },\n            navigation: {\n                nextEl: '.wrap-slider-products .swiper-button-next',\n                prevEl: '.wrap-slider-products .swiper-button-prev',\n            },\n            watchOverflow: true,\n        });\n\n        slider.on('init resize', () => {\n            const show = !slider.isLocked;\n            slider.el\n                .querySelectorAll('.swiper-button-next, .swiper-button-prev')\n                .forEach(btn => (btn.style.display = show ? '' : 'none'));\n        });\n    }\n\n    if ($('.slider-info').length) {\n        new Swiper('.slider-info', {\n            loop: true,\n            spaceBetween: 24,\n            pagination: { el: '.swiper-pagination' },\n            navigation: {\n                nextEl: '.swiper-nav .swiper-button-next',\n                prevEl: '.swiper-nav .swiper-button-prev',\n            },\n        });\n    }\n\n    if ($('.blog-slider').length) {\n        new Swiper('.blog-slider', {\n            spaceBetween: 24,\n            breakpoints: {\n                650: { slidesPerView: 2 },\n                1025: { slidesPerView: 3 },\n            },\n            pagination: { el: '.swiper-pagination' },\n            navigation: {\n                nextEl: '.wrap-slider-posts .swiper-button-next',\n                prevEl: '.wrap-slider-posts .swiper-button-prev',\n            },\n        });\n    }\n}\n\n// ================== SLIDER IN TABS ==================\n\nlet tabsSlider = null;\n\nfunction initTabsSlider() {\n    const exists = $('.slider-posts').length > 0;\n\n    if (exists) {\n        if (!tabsSlider) {\n            tabsSlider = new Swiper('.slider-posts', {\n                spaceBetween: 20,\n                pagination: { el: '.swiper-pagination' },\n                navigation: {\n                    nextEl: '.wrap-slider-posts .swiper-button-next',\n                    prevEl: '.wrap-slider-posts .swiper-button-prev',\n                },\n                breakpoints: {\n                    650: { slidesPerView: 2 },\n                    1025: { slidesPerView: 3 },\n                },\n            });\n        }\n    } else {\n        if (Array.isArray(tabsSlider)) {\n            tabsSlider.forEach(slider => destroySwiper(slider));\n        } else {\n            destroySwiper(tabsSlider);\n        }\n        tabsSlider = null;\n    }\n}\n\n// ================== TABS ==================\n\nfunction initTabs() {\n    $('.tabs').each(function () {\n        const $tabs = $(this);\n        const $links = $tabs.find('.tabs__nav-link');\n        const $wrapper = $tabs.find('.tabs__content-wrapper');\n        const $panes = $tabs.find('.tab-pane');\n\n        function animateHeight($pane) {\n            const start = $wrapper.height();\n            $pane.show();\n            const target = $pane.outerHeight();\n            $pane.hide();\n\n            $wrapper.height(start);\n            requestAnimationFrame(() => {\n                $wrapper.height(target);\n                setTimeout(() => $wrapper.css('height', 'auto'), 300);\n            });\n        }\n\n        $links.on('click', function (e) {\n            e.preventDefault();\n            const $link = $(this);\n            if ($link.hasClass('active')) return;\n\n            const id = $link.attr('href');\n            const $pane = $tabs.find(id);\n\n            $links.removeClass('active');\n            $link.addClass('active');\n\n            animateHeight($pane);\n            $panes.removeClass('active').hide();\n            $pane.addClass('active').show();\n\n            initTabsSlider();\n\n            if (tabsSlider) {\n                if (Array.isArray(tabsSlider)) {\n                    tabsSlider.forEach(slider => slider.update());\n                } else {\n                    tabsSlider.update();\n                }\n            }\n\n            setTimeout(initVisibleTabAllergens, 20);\n        });\n\n        const $first = $panes.filter('.active');\n        $wrapper.height($first.outerHeight());\n        setTimeout(() => $wrapper.css('height', 'auto'), 300);\n    });\n}\n\n// ================== FLOWERING CALENDAR ==================\n\nfunction initFloweringCalendar() {\n    const $wrap = $('.month-wrap');\n    if (!$wrap.length) return;\n\n    const currentMonth = new Date().getMonth();\n\n    function update() {\n        console.log(11)\n        if (window.innerWidth > BREAKPOINTS.tablet) {\n            if (!$wrap.hasClass('mCustomScrollbar')) {\n                $wrap.mCustomScrollbar({\n                    axis: 'x',\n                    theme: 'my-theme',\n                });\n\n                const $months = $wrap.find('.month-block');\n                const $current = $('#month-' + currentMonth);\n                console.log(111)\n                if ($current.length) {\n                    const index = $months.index($current);\n                    const offset = (100 / 12) * (index + 1) + '%';\n\n                    setTimeout(() => {\n                        $wrap.mCustomScrollbar('scrollTo', offset);\n                    }, 1000);\n                }\n            }\n        } else {\n            if ($wrap.hasClass('mCustomScrollbar')) {\n                $wrap.mCustomScrollbar('destroy');\n            }\n        }\n    }\n\n    update();\n    window.addEventListener('resize', debounce(update, 300));\n}\n\n// ================== ACCORDION ==================\n\nfunction initAccordion() {\n    $('#accordion').on('click', '.panel__heading', function () {\n        const $heading = $(this);\n        const $panel = $heading.siblings('.panel-collapse');\n\n        if ($heading.hasClass('open')) {\n            $heading.removeClass('open');\n            $panel.slideUp(300);\n        } else {\n            $('#accordion .panel__heading').removeClass('open');\n            $('.panel-collapse').slideUp(300);\n            $heading.addClass('open');\n            $panel.slideDown(300);\n        }\n    });\n}\n\n// ================== COUNTERS ==================\n\nfunction initCounters() {\n    const numbers = document.querySelectorAll('.counter__number');\n    if (!numbers.length) return;\n\n    const observer = new IntersectionObserver(entries => {\n        entries.forEach(entry => {\n            if (!entry.isIntersecting) return;\n\n            const el = entry.target;\n            const target = +el.dataset.target;\n            const prefix = el.dataset.prefix || '';\n            const suffix = el.dataset.suffix || '';\n            const startTime = performance.now();\n\n            function step(time) {\n                const progress = Math.min((time - startTime) / 2000, 1);\n                el.textContent = prefix + Math.floor(progress * target) + suffix;\n                if (progress < 1) requestAnimationFrame(step);\n            }\n\n            requestAnimationFrame(step);\n            observer.unobserve(el);\n        });\n    }, { threshold: 0.5 });\n\n    numbers.forEach(n => observer.observe(n));\n}\n\n// ================== MODAL ==================\n\nfunction initModal() {\n    const dialog = document.getElementById('modal-calendar');\n    const closeBtn = document.getElementById('closeDialog');\n\n    $('.more-plants').on('click', function (e) {\n        e.preventDefault();\n        const block = $(this).closest('.month-block');\n        const id = block.attr('id'); // ✅ use jQuery attr\n        openDialogForMonth(id);\n    });\n\n    function openDialogForMonth(monthId) {\n        // You can use monthId here if needed\n        dialog.showModal();\n        lockScroll();\n    }\n\n    if (dialog && closeBtn) {\n        closeBtn.addEventListener('click', () => {\n            dialog.close();\n            unlockScroll();\n        });\n\n        $(dialog).on('click', function (e) {\n            const rect = dialog.getBoundingClientRect();\n            const inside =\n                e.clientX >= rect.left && e.clientX <= rect.right &&\n                e.clientY >= rect.top && e.clientY <= rect.bottom;\n\n            if (!inside) {\n                dialog.close();\n                unlockScroll();\n            }\n        });\n    }\n}\n\n// ================== INIT ==================\n\n$(document).ready(function () {\n    initMobileMenu();\n    initHeaderSearch();\n    initSmoothScroll('.article__nav a, .menu__link, .scroll-to');\n    initVideo();\n    initResponsiveCounterSlider();\n    initStaticSliders();\n    initTabsSlider();\n    initTabs();\n    initAccordion();\n    initCounters();\n    initFloweringCalendar();\n    initModal();\n    initVisibleTabAllergens();\n\n    $('.filter__select').select2({\n        width: '100%',\n        minimumResultsForSearch: -1,\n    });\n});\n\n$(window).on('resize', debounce(initVisibleTabAllergens, 200));\n"],"file":"main.js"}